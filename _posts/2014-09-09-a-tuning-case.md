---
layout: post
title: 记一次简单性能诊断过程
date: 2014-09-09
categories: blog
tags: [SQL优化]
description: 记一次简单性能诊断过程
---

```sql

客户每月第N天一个批量程序突然运行时间加长，但是除了第N天其他日期执行时间都比较短

我简单说下问题处理的过程及思路

想法 ：首先我要确定第N天是不是突然增加了一些其他业务，引起计算资源不足

方法：收集N天 跑批时段awr  收集N-1天同时段awr 观察load profile  与top event 

结果： 发现各指标波动不大 排除操作系统计算资源不足



想法：由Oracle参数引起

方法：1 询问客户是否有改动参数

    2 查看警告日志

            3 对比awr报告中的init.ora部分

结果 ：没有更改过



想法: 执行计划不同

方法：使用awrsqlrpt.sql 分别取第N-1天与第N天的执行计划

结果：发现执行计划关联顺序不同





想法 :固定执行计划

方法 使用提示（ordered hint）固定执行计划  

结果 执行计划固定成功

```
